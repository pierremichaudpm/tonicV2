<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Accueil | Groupe Tonic</title>
    <meta name="description" content="Groupe Tonic, créateur d'expériences mémorables depuis plus de 40 ans. Beach Pro Tour, Grands Prix Cyclistes, Marathon Beneva et événements majeurs au Québec.">
    <meta property="og:title" content="Tonic - Créateur d'expériences mémorables">
    <meta property="og:description" content="Découvrez nos événements sportifs majeurs et espaces événementiels">
    <meta property="og:image" content="images/beach-pro-tour-hero.webp">
    <meta property="og:type" content="website">
    <link rel="stylesheet" href="css/shared.css">
    <link rel="preload" href="https://fonts.cbc.ca/fonts/CBCSans-Bold.woff2" as="font" type="font/woff2" crossorigin>
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.cbc.ca">
    <style>
        @font-face{font-family:'CBC Sans';font-weight:400;font-display:swap;src:url('https://fonts.cbc.ca/fonts/CBCSans-Regular.woff2') format('woff2')}
        @font-face{font-family:'CBC Sans';font-weight:700;font-display:swap;src:url('https://fonts.cbc.ca/fonts/CBCSans-Bold.woff2') format('woff2')}
        @font-face{font-family:'CBC Sans';font-weight:900;font-display:swap;src:url('https://fonts.cbc.ca/fonts/CBCSans-Black.woff2') format('woff2')}
        *{box-sizing:border-box;font-family:'CBC Sans',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
        body{margin:0;background:#000;overflow-x:hidden;min-height:100vh;min-height:100dvh;overscroll-behavior:none}
        
        /* Core animations */
        @keyframes fadeInSoft{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        @keyframes scaleIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
        @keyframes slideIn{from{opacity:0;transform:translateX(-30px)}to{opacity:1;transform:translateX(0)}}
        @keyframes subtleZoom{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}
        @keyframes float{0%,100%{transform:translateY(0) translateX(0);opacity:.3}50%{transform:translateY(-30px) translateX(10px);opacity:.8}}
        @keyframes pulse{0%,100%{opacity:.7}50%{opacity:1}}
        @keyframes progress{from{transform:scaleX(0)}to{transform:scaleX(1)}}
        @keyframes progressLine{from{width:0}to{width:100%}}
        @keyframes gridProgress{from{width:0}to{width:100%}}
        @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
        @keyframes fadeInOut{0%{opacity:0;transform:translate(-50%,-50%) scale(.8)}20%{opacity:1;transform:translate(-50%,-50%) scale(1)}80%{opacity:1;transform:translate(-50%,-50%) scale(1)}100%{opacity:0;transform:translate(-50%,-50%) scale(.95)}}
        
        /* Base components */
        .view-container{position:fixed;inset:0;opacity:0;pointer-events:none;transition:opacity .5s ease}
        .view-container.active{opacity:1;pointer-events:auto}
        .splash-container{position:fixed;inset:0;z-index:100;background:#000;display:flex;align-items:center;justify-content:center;padding:2rem;flex-direction:column}
        .splash-logo{width:clamp(300px,50vw,600px);height:auto;opacity:0;animation:fadeInSoft 1.2s ease-out forwards;filter:drop-shadow(0 4px 20px rgba(0,0,0,.8))}
        .splash-tagline{font-size:clamp(1rem,2.5vw,1.5rem);font-weight:500;color:#fff;text-align:center;text-shadow:0 2px 10px rgba(0,0,0,.8);opacity:0;animation:fadeInSoft 1.2s ease-out .3s forwards;margin-top:3rem}
        
        /* Grid - Updated 2:34 AM for MUCH darker backgrounds */
        .grid-selection-container{position:fixed;inset:0;z-index:90;background:#000;display:flex;flex-direction:column;height:100vh;height:100dvh;overflow:hidden}
        .grid-selection-container header{flex-shrink:0;height:65px}
        .grid-wrapper{flex:1;padding:calc(80px + 0.25rem) max(1.5rem,3vw) 0.25rem;display:flex;align-items:center;justify-content:center;min-height:0;overflow:hidden}
        .selection-grid{display:grid;gap:12px;width:100%;height:100%;max-width:min(1190px,90vw);max-height:min(85%,85vh);margin:auto}
        .selection-tile{position:relative;width:100%;height:100%;min-height:0;border-radius:12px;overflow:hidden;cursor:pointer;transition:all .3s ease;animation:scaleIn .5s ease-out forwards;animation-delay:calc(var(--index) * .05s);opacity:0;box-shadow:0 4px 15px rgba(0,0,0,.3)}
        .selection-tile:hover{transform:scale(1.02);z-index:10;box-shadow:0 10px 30px rgba(0,0,0,.5)}
        .selection-tile-bg{position:absolute;inset:0;background-size:cover;background-position:center;transition:transform .3s ease}
        .selection-tile:hover .selection-tile-bg{transform:scale(1.05)}
        .selection-tile-overlay{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:space-between;padding:clamp(.75rem,2vw,1.25rem);padding-bottom:clamp(1rem,2.5vw,1.5rem)}

        .selection-tile-content{position:relative;z-index:2}
        .selection-tile-logo{max-height:clamp(30px,5vh,50px);max-width:clamp(80px,15vw,140px);object-fit:contain;filter:drop-shadow(0 2px 6px rgba(0,0,0,.8));opacity:.95}
        .selection-tile-content{display:flex;flex-direction:column;gap:.25rem;min-height:3.5rem;justify-content:flex-end}
        .selection-tile-title{font-size:clamp(.875rem,1.5vw,1.25rem);font-weight:900;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.9);line-height:1.1}
        .selection-tile-date{font-size:clamp(.65rem,1vw,.875rem);color:rgba(255,255,255,.9);font-weight:500}
        .selection-tile-tagline{font-size:clamp(.88rem,1.35vw,1.08rem);color:rgba(255,255,255,.85);font-weight:700;text-transform:uppercase;letter-spacing:.05em;line-height:1.2;text-shadow:0 2px 6px rgba(0,0,0,.8)}
        
        /* Progress indicators */
        .grid-progress-bar{position:fixed;bottom:0;left:0;right:0;height:6px;background:rgba(255,255,255,.1);z-index:95;display:none}
        .grid-progress-fill{height:100%;background:linear-gradient(90deg,color-mix(in srgb,var(--accent-primary) 10%,#000) 0%,color-mix(in srgb,var(--accent-primary) 20%,#000) 15%,color-mix(in srgb,var(--accent-primary) 40%,#000) 30%,color-mix(in srgb,var(--accent-primary) 60%,#000) 45%,var(--accent-primary) 60%,var(--accent-hover) 75%,var(--accent-light) 90%,color-mix(in srgb,var(--accent-light) 60%,#fff) 100%);animation:gridProgress 10s linear forwards;transform-origin:left;box-shadow:0 0 25px var(--accent-shadow),0 0 10px var(--accent-30)}
        .progress-bar{position:absolute;bottom:0;left:0;height:4px;background:var(--accent-color);animation:progress 7s linear forwards;transform-origin:left;transform:scaleX(0);box-shadow:0 0 15px var(--accent-color);border-radius:0 3px 3px 0;z-index:10}
        .progress-bar.paused{animation-play-state:paused}
        .desktop-progress{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%);z-index:40;display:none;align-items:center;gap:.75rem}
        .progress-line{width:80px;height:5px;background:rgba(255,255,255,.3);cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden;border-radius:3px}
        .progress-line:hover{background:rgba(255,255,255,.4);transform:scaleY(1.3);box-shadow:0 2px 8px rgba(255,255,255,.2)}
        .progress-line.active{background:rgba(255,255,255,.5)}
        .progress-line.active::after{content:'';position:absolute;left:0;top:0;height:100%;background:var(--accent-color);animation:progressLine 7s linear forwards;box-shadow:0 0 10px var(--accent-color),0 0 20px var(--accent-color)}
        .progress-line.active.paused::after{animation-play-state:paused}
        
        /* Navigation */
        .lang-switcher{display:flex;align-items:center;gap:.25rem;padding:.25rem .5rem;border-radius:.5rem;color:rgba(255,255,255,.9);transition:all .2s ease;font-size:.75rem;font-weight:500;text-decoration:none;cursor:pointer}
        .lang-switcher:hover{background:rgba(255,255,255,.1);color:#fff}
        .lang-divider{width:1px;height:16px;background:rgba(255,255,255,.2);margin:0 .5rem}
        .side-nav-wrapper{position:fixed;right:0;top:50%;transform:translateY(-50%);z-index:40;max-height:70vh;max-width:280px}
        .side-nav-item{position:relative;cursor:pointer;transition:all .3s ease;border-radius:8px;margin-bottom:4px;overflow:hidden}
        .side-nav-item:hover{transform:translateX(-8px);background:rgba(255,255,255,.1)}
        .side-nav-item.active{background:rgba(255,255,255,.15);transform:translateX(-12px)}
        
        /* Hero */
        .hero-bg{animation:subtleZoom 60s ease-in-out infinite;transition:opacity .6s ease-out,transform .6s ease-out}
        .hero-transition-wrapper{position:absolute;inset:0;opacity:1;transition:opacity .5s ease-in-out}
        .particle{position:absolute;width:2px;height:2px;background:rgba(255,255,255,.6);border-radius:50%;animation:float 12s ease-in-out infinite}
        .hero-main-content{cursor:grab;position:relative;z-index:30}
        .hero-main-content:active{cursor:grabbing}
        .hero-content{animation:fadeIn .8s ease-out;position:relative;z-index:35}
        .hero-content>*{animation:slideIn .6s ease-out forwards;animation-delay:calc(var(--child-index) * .1s);opacity:0;animation-fill-mode:both}
        .hero-content>*:nth-child(5),.hero-content>*:nth-child(6),.hero-content .cta-button-custom{animation-fill-mode:both!important}
        @media(prefers-reduced-motion:no-preference){.hero-content .cta-button-custom{animation:slideIn .6s ease-out .5s both!important}}
        .hero-logo-container{display:block;margin:0;padding:0;text-align:left}
        .hero-logo-container img{display:block;margin:0;padding:0;transform-origin:left center!important}
        
        /* Mobile */
        .mobile-dots{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%);z-index:40;display:none;flex-direction:column;align-items:center;gap:.5rem;padding-bottom:env(safe-area-inset-bottom)}
        .swipe-indicator{font-size:.65rem;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.1em;font-weight:500;animation:pulse 2s ease-in-out infinite;text-shadow:0 2px 8px rgba(0,0,0,.8);margin-bottom:.25rem}
        .dots-container{display:flex;flex-direction:row;align-items:center;gap:.5rem}
        .dot{width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,.4);cursor:pointer;transition:all .3s ease}
        .dot.active{width:24px;border-radius:4px;background:var(--accent-color)}
        
        /* CTA Button */
        .cta-button-custom{background-size:200% 200%;animation:gradientShift 3s ease infinite;color:#fff;font-weight:700;padding:1rem 2rem;border-radius:50px;display:inline-flex;align-items:center;gap:.75rem;transition:all .3s ease;text-decoration:none;position:relative;overflow:hidden;letter-spacing:.02em;font-size:1rem;border:1px solid rgba(255,255,255,.1);z-index:1;cursor:pointer}
        .cta-button-custom:hover{transform:translateY(-2px);filter:brightness(1.1)}
        .cta-button-custom svg{width:1.25rem;height:1.25rem;flex-shrink:0;transition:transform .3s ease}
        .cta-button-custom span{position:relative;z-index:1;white-space:nowrap;color:#fff!important}
        .cta-button-custom.dock619-cta span{color:#333!important}
        .cta-button-custom.dock619-cta svg{stroke:#333}
        
        /* Enhanced Dock 619 text readability */
        .hero-content[data-dock619="true"] .hero-title,
        .hero-content[data-dock619="true"] .hero-tagline,
        .hero-content[data-dock619="true"] .hero-date,
        .hero-content[data-dock619="true"] .hero-location {
            text-shadow: 0 4px 20px rgba(0,0,0,0.95), 0 2px 10px rgba(0,0,0,0.9), 0 1px 5px rgba(0,0,0,0.8) !important;
            background: linear-gradient(135deg, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.4) 100%);
            backdrop-filter: blur(8px);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        /* Other components */
        .countdown-unit{background:rgba(0,0,0,.6);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:12px;padding:.75rem 1rem;text-align:center;min-width:60px}
        .pause-indicator{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:45;opacity:0;pointer-events:none;transition:opacity .3s ease}
        .pause-indicator.visible{opacity:1;animation:fadeInOut 1s ease-out}
        .pause-icon{width:80px;height:80px;background:rgba(0,0,0,.6);backdrop-filter:blur(10px);border-radius:50%;display:flex;align-items:center;justify-content:center;gap:8px}
        .pause-bar{width:6px;height:30px;background:#fff;border-radius:3px}
        .header-logo{cursor:pointer;transition:transform .2s ease}
        .header-logo:hover{transform:scale(1.05)}
        .dock619-grid-content,.studio76-grid-content{display:flex;flex-direction:column;justify-content:space-between;height:100%}
        .dock619-grid-top,.studio76-grid-top{display:flex;justify-content:space-between;align-items:flex-start}
        
        @supports not (animation: slideIn 1s){.hero-content>*{opacity:1!important}}
        .hero-content .cta-button-custom{display:inline-flex!important}
        
        /* Grid layouts */
        @media(min-width:1024px) and (max-width:2999px){
            .selection-grid{grid-template-columns:repeat(12,1fr)!important;grid-template-rows:repeat(2,1fr)!important;grid-auto-flow:dense}
            .selection-tile:nth-child(1){grid-column:1/4!important;grid-row:1/2!important}
            .selection-tile:nth-child(2){grid-column:4/7!important;grid-row:1/2!important}
            .selection-tile:nth-child(3){grid-column:7/10!important;grid-row:1/2!important}
            .selection-tile:nth-child(4){grid-column:10/13!important;grid-row:1/2!important}
            .selection-tile:nth-child(5){grid-column:1/5!important;grid-row:2/3!important}
            .selection-tile:nth-child(6){grid-column:5/9!important;grid-row:2/3!important}
            .selection-tile:nth-child(7){grid-column:9/13!important;grid-row:2/3!important}
        }
        @media(min-width:768px) and (max-width:1023px){
            .selection-grid{grid-template-columns:repeat(6,1fr);grid-template-rows:repeat(3,1fr);grid-template-areas:"a a b b c c" "d d e e f f" ". . g g . ."}
            .selection-tile:nth-child(1){grid-area:a}
            .selection-tile:nth-child(2){grid-area:b}
            .selection-tile:nth-child(3){grid-area:c}
            .selection-tile:nth-child(4){grid-area:d}
            .selection-tile:nth-child(5){grid-area:e}
            .selection-tile:nth-child(6){grid-area:f}
            .selection-tile:nth-child(7){grid-area:g}
            .grid-wrapper{padding-top:calc(80px + 0.25rem)}
        }
        @media(min-width:480px) and (max-width:767px){
            .selection-grid{grid-template-columns:repeat(4,1fr);grid-template-rows:repeat(4,minmax(0,1fr));grid-template-areas:"a a b b" "c c d d" "e e f f" ". g g ."}
            .selection-grid::after{content:'';display:block;height:4rem;width:100%;grid-column:1/-1}
            .selection-tile:nth-child(1){grid-area:a}
            .selection-tile:nth-child(2){grid-area:b}
            .selection-tile:nth-child(3){grid-area:c}
            .selection-tile:nth-child(4){grid-area:d}
            .selection-tile:nth-child(5){grid-area:e}
            .selection-tile:nth-child(6){grid-area:f}
            .selection-tile:nth-child(7){grid-area:g}
            .grid-wrapper{padding-top:calc(80px + 0.25rem)}
        }
        @media(max-width:479px){
            .grid-wrapper{overflow-y:auto;-webkit-overflow-scrolling:touch;padding:calc(85px + 0.75rem) 1rem 1.5rem;padding-top:calc(85px + max(0.75rem,env(safe-area-inset-top) + 0.25rem));padding-bottom:max(1.5rem,env(safe-area-inset-bottom) + 1.5rem)}
            .selection-grid{grid-template-columns:1fr;grid-auto-rows:minmax(135px,auto);max-height:none;gap:20px;padding-bottom:6rem}
            .selection-grid::after{content:'';display:block;height:5rem;width:100%}
            .selection-tile:last-child{margin-bottom:4rem}
            .selection-tile{position:relative}

            .countdown-unit{padding:.5rem .75rem;min-width:50px}
        }
        @media(min-width:3000px) and (min-height:1200px){
            .selection-grid{grid-template-columns:repeat(7,1fr);grid-template-rows:1fr;grid-auto-flow:column}
            .selection-tile{grid-column:auto!important;grid-row:1!important}
        }
        @media(min-width:640px){.grid-selection-container header{height:80px}}
        @media(min-width:768px){.selection-tile{aspect-ratio:auto}.desktop-progress{display:flex}}
        @media(max-width:767px){.selection-tile{aspect-ratio:16/9}}
        @media(max-width:768px){
            .mobile-dots{display:flex}
            .desktop-progress{display:none!important}
            .hero-main-content{padding-top:max(8rem,env(safe-area-inset-top) + 7rem);padding-bottom:max(6rem,env(safe-area-inset-bottom) + 4rem);min-height:100vh;min-height:-webkit-fill-available;min-height:100dvh}
            .hero-content{max-width:100%;overflow-x:hidden}
            @media(max-height:700px) and (max-width:400px){
                .hero-content h2{font-size:1.75rem!important}
                .hero-content p{font-size:1rem!important}
                .countdown-unit{display:none}
            }
            .grid-selection-container{padding-top:env(safe-area-inset-top)}
            .hero-bg{animation:none!important}
            .hero-content>*{animation:fadeIn .4s ease-out forwards!important}
            .particle{display:none!important}
            .hero-content .hero-logo-container img{height:auto!important;max-height:5rem}
            .hero-logo-container{overflow:visible!important;margin-bottom:1.5rem!important;min-height:4.5rem;display:flex;align-items:flex-start}
            .hero-content .hero-logo-container:has(img[alt="Studio 76"]){padding-top:.5rem;min-height:5rem}
        }
        @media(max-width:640px){
            .header-tagline-grid{margin-top:0.375rem;padding-left:0.25rem;max-width:none!important;line-height:1.2}
            .header-tagline-hero{margin-top:0.25rem;padding-left:0.125rem;max-width:220px!important;line-height:1.3}
        }
        @media(min-width:769px){.mobile-dots{display:none!important}}
        @supports(-webkit-touch-callout:none){
            .hero-main-content{min-height:100vh;min-height:-webkit-fill-available}
            @media(max-width:768px){
                header{padding-top:env(safe-area-inset-top)}
                .hero-content{max-height:calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 8rem)}
            }
            @media(max-width:768px) and (min-width:480px){
                .grid-wrapper{height:calc(100vh - 80px - env(safe-area-inset-top));padding-top:calc(80px + 2rem)}
            }
        }
        @media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}
        @-moz-document url-prefix(){
            @media(min-width:1024px) and (max-width:2999px){
                .selection-grid{grid-template-areas:none!important;display:grid!important;grid-template-columns:repeat(12,1fr)!important;grid-template-rows:repeat(2,1fr)!important}
            }
        }
        .mobile-container{position:relative;min-height:100vh;min-height:-webkit-fill-available;overflow:hidden}
        .category-tonic{background:linear-gradient(135deg,var(--accent-primary),var(--accent-50))}
    </style>
</head>
<body>
    <noscript>
        <div style="min-height:100vh;background:#000;color:#fff;display:flex;align-items:center;justify-content:center;padding:2rem;text-align:center">
            <div>
                <img src="images/tonic-logo.png" alt="Groupe Tonic" style="width:clamp(200px,40vw,300px);height:auto;margin-bottom:1rem;" />
                <p style="margin-bottom:2rem;opacity:.8">Ce site nécessite JavaScript pour fonctionner correctement. Veuillez l'activer dans votre navigateur.</p>
            </div>
        </div>
    </noscript>
    <div id="root"></div>
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel" data-type="module">
        const { useState, useEffect, useRef, useMemo, useCallback, memo } = React;

        // Constants
        const SPLASH_DURATION = 2000;
        const GRID_PROGRESS_DURATION = 10000;
        const AUTO_PLAY_INTERVAL = 7000;
        const TRANSITION_DELAY = 300;
        const WHEEL_THROTTLE = 500;
        const MOBILE_BREAKPOINT = 768;
        const TOUCH_THRESHOLD = 50;
        const PAUSE_INDICATOR_DURATION = 1000;
        const COUNTDOWN_INTERVAL = 1000;
        const DEBOUNCE_DELAY = 250;
        const PARTICLE_COUNT = 4;

        // Utilities
        const getCSSVariable = n => getComputedStyle(document.documentElement).getPropertyValue(n).trim();
        const debounce = (f, w) => { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => f(...a), w); }; };

        // Color utilities
        const hexToRgb = (hex) => {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        };

        const rgbToHex = (r, g, b) => "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);

        const generateColorShades = (baseColor) => {
            const rgb = hexToRgb(baseColor);
            if (!rgb) return { base: baseColor, light: baseColor, dark: baseColor, glow: baseColor };
            
            return {
                base: baseColor,
                light: rgbToHex(Math.min(255, rgb.r + 51), Math.min(255, rgb.g + 51), Math.min(255, rgb.b + 51)),
                dark: rgbToHex(Math.max(0, rgb.r - 51), Math.max(0, rgb.g - 51), Math.max(0, rgb.b - 51)),
                glow: `${baseColor}44`
            };
        };

        // Icons
        const Icons = {
            cal: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
            grid: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>,
            info: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>,
            loc: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>,
            arr: <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
            menu: <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>,
            x: <svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            work: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>,
            news: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"/><path d="M10 6h8"/><path d="M10 10h8"/><path d="M10 14h4"/></svg>,
            mail: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>,
            lang: <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 5h12v4H3zM3 15h12v4H3zM8 10v4"/></svg>
        };

        // Logo scales
        const LOGO_SCALES = {
            4: { mobile: .66, desktop: .5 },
            1: { mobile: .7632, desktop: .578 },
            5: { mobile: .9504, desktop: .72 },
            3: { mobile: 1.0932, desktop: .828 },
            2: { mobile: 1.0824, desktop: .82 },
            6: { mobile: 1.1904, desktop: .902 },
            7: { mobile: .768, desktop: .96 }
        };

        // Properties data
        const PROPERTIES = [
            {id:4,name:"BEACH PRO TOUR",tagline:"L'élite mondiale du volleyball de plage",category:"CIRCUIT INTERNATIONAL",date:"13-17 août 2025",location:"Montréal",color:"#ff0e9b",image:"images/beach-pro-tour-hero.webp",logo:"images/beach-pro-tour-logo.png",url:"https://mtlbeachprotour.com/",countdown:new Date('2025-08-13'),theme:{primary:"from-pink-600 to-pink-500",secondary:"from-pink-900 to-pink-700"}},
            {id:2,name:"GRANDS PRIX CYCLISTES",tagline:"Les seules épreuves UCI WorldTour en Amérique",category:"CYCLISME INTERNATIONAL",date:"12 & 14 septembre 2025",location:"Québec & Montréal",color:"#b7d233",image:"images/grands-prix-cyclistes-hero.jpg",logo:"images/GPCQM-logo.png",url:"https://gpcqm.ca/",countdown:new Date('2025-09-12'),theme:{primary:"from-lime-600 to-lime-500",secondary:"from-lime-900 to-lime-700"}},
            {id:1,name:"MARATHON BENEVA DE MONTRÉAL",tagline:"Vivez-le!",category:"COURSE À PIED",date:"19-21 septembre 2025",location:"Montréal, QC",color:"#463092",menuColor:"#957ab7",image:"images/marathon-beneva-hero.jpg",logo:"images/marathon-beneva-logo.png",url:"https://couronsmtl.com/marathon-beneva/accueil/",countdown:new Date('2025-09-19'),theme:{primary:"from-indigo-700 to-indigo-600",secondary:"from-indigo-900 to-indigo-800"}},
            {id:5,name:"21K DE MONTRÉAL",tagline:"Démarrez en grand votre saison de course",category:"COURSE À PIED",date:"Avril 2026",location:"Montréal",color:"#e2493c",image:"images/21k-hero.jpg",logo:"images/21k-logo.png",url:"https://couronsmtl.com/21k/accueil/",countdown:new Date('2026-04-01'),theme:{primary:"from-red-500 to-red-400",secondary:"from-red-800 to-red-700"}},
            {id:3,name:"CHAMPIONNATS DU MONDE ROUTE UCI MONTRÉAL 2026",tagline:"Montréal, capitale mondiale du vélo",category:"MONDIAUX",date:"19-27 septembre 2026",location:"Montréal, QC",color:"#da273b",image:"images/montreal-2026-uci-hero.jpg",logo:"images/montreal-2026-uci-logo.png",url:"https://www.montreal2026.org/",countdown:new Date('2026-09-19'),theme:{primary:"from-red-700 to-red-600",secondary:"from-red-900 to-red-800"}},
            {id:6,name:"STUDIO 76",tagline:"Services intégrés en production vidéo, télévisuelle et création de contenus de marque, pour donner vie à des projets percutants et sur mesure",category:"PRODUCTION",date:"",location:"Longueuil, QC",color:"#03b0f9",image:"images/tonic-productions-hero.jpg",logo:"images/studio76-logo.png",url:"https://studio-76.replit.app/",theme:{primary:"from-blue-500 to-blue-400",secondary:"from-blue-900 to-blue-700"}},
            {id:7,name:"DOCK 619",tagline:"Pour vos mariages, rassemblements familiaux, lancements de produits, fêtes privées, journées corporatives ou tout autre événement, choisissez le Dock 619 et son espace sans pareil",category:"LIEU ÉVÉNEMENTIEL",date:"",location:"Longueuil, QC",color:"#ffffff",image:"images/dock619-hero-new.jpg",logo:"images/dock619-logo.png",url:"https://dock619.ca/",theme:{primary:"from-gray-600 to-gray-400",secondary:"from-gray-900 to-gray-700"}}
        ];

        // Navigation factory
        const createNavItems = (goToGrid) => [
            {href:'index.html',icon:Icons.grid,label:'Accueil',onClick:e=>{e.preventDefault();goToGrid()}},
            {href:'a-propos.html',icon:Icons.info,label:'À propos'},
            {href:'emplois.html',icon:Icons.work,label:'Emplois'},
            {href:'communiques.html',icon:Icons.news,label:'Communiqués'},
            {href:'nous-joindre.html',icon:Icons.mail,label:'Nous joindre'}
        ];

        // Header Component
        const Header = memo(({goToGrid,isMobileMenuOpen,setIsMobileMenuOpen,currentView}) => {
            const navItems = useMemo(() => createNavItems(goToGrid), [goToGrid]);
            const [headerScrolled, setHeaderScrolled] = useState(false);
            
            useEffect(() => {
                const gridWrapper = document.querySelector('.grid-wrapper');
                if (!gridWrapper || currentView !== 'grid') return;
                
                const handleScroll = () => {
                    const scrollTop = gridWrapper.scrollTop;
                    setHeaderScrolled(scrollTop > 20);
                };
                
                gridWrapper.addEventListener('scroll', handleScroll);
                return () => gridWrapper.removeEventListener('scroll', handleScroll);
            }, [currentView]);

            const headerStyle = useMemo(() => ({
                background: currentView === 'grid' 
                    ? headerScrolled 
                        ? 'linear-gradient(180deg, rgba(0,0,0,0.98) 0%, rgba(0,0,0,0.95) 50%, rgba(0,0,0,0.85) 100%)'
                        : 'rgba(0,0,0,0.95)'
                    : 'linear-gradient(to bottom,rgba(0,0,0,0.2),rgba(0,0,0,0.02) 30%,transparent 60%)',
                backdropFilter: currentView === 'grid' ? 'blur(20px) saturate(180%)' : 'none',
                WebkitBackdropFilter: currentView === 'grid' ? 'blur(20px) saturate(180%)' : 'none',
                boxShadow: currentView === 'grid' 
                    ? headerScrolled 
                        ? '0 8px 40px rgba(0,0,0,0.8), 0 2px 20px rgba(0,0,0,0.6)'
                        : '0 4px 30px rgba(0,0,0,0.5)'
                    : 'none',
                transition: 'all 0.3s ease'
            }), [currentView, headerScrolled]);

            return (
                <header className="fixed top-0 left-0 right-0 z-50" style={headerStyle}>
                    <div className="container mx-auto px-2 py-2 sm:px-4 sm:py-5">
                        <div className="flex items-center justify-between">
                            <div className="flex flex-col sm:flex-row items-start sm:items-center gap-0 sm:gap-4">
                                <h1 className="header-logo text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black text-white leading-none" 
                                    style={{textShadow:'0 4px 20px rgba(0,0,0,0.9), 0 2px 10px rgba(0,0,0,0.8)'}}
                                    onClick={goToGrid}>
                                    <img src="images/tonic-logo.png" alt="Groupe Tonic" style={{width:'clamp(180px,35vw,250px)',height:'auto'}} />
                                </h1>
                                <span className="text-white text-xs md:text-sm font-medium leading-tight"
                                    style={{textShadow:'0 2px 10px rgba(0,0,0,0.9)'}}>
                                    <span className="hidden sm:inline">| Créateur d'expériences mémorables</span>
                                    <span className="sm:hidden">Créateur d'expériences mémorables</span>
                                </span>
                            </div>
                            <div className="flex items-center gap-4">
                                <nav className="hidden md:flex lg:flex items-center gap-0.5 px-2 py-0.5 rounded-full nav-container" style={{background:'rgba(0,0,0,0.2)',backdropFilter:'blur(10px)'}}>
                                    {navItems.map(i => (
                                        <a key={i.label} onClick={i.onClick} href={i.href} className="nav-item flex items-center gap-1 px-2 py-1 rounded-lg hover:bg-white/10 transition-all text-white hover:text-white cursor-pointer" data-tooltip={i.label}>
                                            {i.icon}
                                            <span className="text-xs font-medium">{i.label}</span>
                                        </a>
                                    ))}
                                    <div className="lang-divider"></div>
                                    <a href="index-en.html" className="lang-switcher"><span>EN</span></a>
                                </nav>
                                <button onClick={()=>setIsMobileMenuOpen(!isMobileMenuOpen)} className="md:hidden p-2 hover:bg-white/10 rounded-lg transition-colors text-white" style={{background:'rgba(0,0,0,0.2)',backdropFilter:'blur(10px)',color:'white'}}>
                                    <div style={{color:'white'}}>{isMobileMenuOpen?Icons.x:Icons.menu}</div>
                                </button>
                            </div>
                        </div>
                    </div>
                </header>
            );
        });

        // Property Tile Component
        const PropertyTile = memo(({property,index,onClick}) => {
            const tileContent = useMemo(() => {
                if(property.id===7) return (
                    <div className="dock619-grid-content">
                        <div className="dock619-grid-top" style={{marginLeft:'-0.25rem',marginTop:'1rem'}}>
                            <img src="images/dock619-logo-2.png" alt="DOCK 619" className="h-3.5 sm:h-4 md:h-5 object-contain" 
                                style={{filter:'drop-shadow(0 2px 8px rgba(0,0,0,0.9))',maxWidth:'100%',transform:'scale(1.04)'}} loading="lazy"/>
                        </div>
                        <div style={{minHeight:'3.5rem',display:'flex',alignItems:'flex-end',paddingBottom:'0.25rem'}}>
                            <p className="selection-tile-tagline">DES ÉVÉNEMENTS<br/>CRÉATIFS ET GOURMANDS</p>
                        </div>
                    </div>
                );
                if(property.id===6) return (
                    <div className="studio76-grid-content">
                        <div className="studio76-grid-top">
                            <img src="images/studio76-logo.png" alt="Studio 76" className="h-14 sm:h-16 md:h-20 object-contain" 
                                style={{filter:'drop-shadow(0 2px 8px rgba(0,0,0,0.9))',maxWidth:'100%',transform:'scale(0.97)'}} loading="lazy"/>
                        </div>
                        <div style={{minHeight:'3.5rem',display:'flex',alignItems:'flex-end',paddingBottom:'0.25rem'}}>
                            <p className="selection-tile-tagline">SERVICES INTÉGRÉS<br/>EN PRODUCTION VIDÉO</p>
                        </div>
                    </div>
                );
                return (
                    <>
                        <div style={{paddingLeft:property.id===2?'2rem':property.id===4?'0.5rem':'0'}}>{property.logo&&<img src={property.logo} alt={property.name} className="selection-tile-logo" 
                            style={{transform:property.id===3?'scale(1.15)':property.id===2?'scale(1.885)':property.id===4?'scale(1.20)':'scale(1)',margin:property.id===3?'0.5rem':'0'}} loading="lazy"/>}</div>
                        <div className="selection-tile-content">
                            <h3 className="selection-tile-title">{property.name}</h3>
                            {property.date&&<p className="selection-tile-date">{property.date}</p>}
                        </div>
                    </>
                );
            }, [property]);

            return (
                <div className="selection-tile" style={{'--index':index,'--brand-color':property.color}} onClick={()=>onClick(index)}>
                    <div className="selection-tile-bg" style={{backgroundImage:property.image?`url(${property.image})`:'none',backgroundColor:property.color}}/>
                    <div className={`absolute inset-0 bg-gradient-to-r ${property.theme.primary} opacity-50`}/>
                    <div className="selection-tile-overlay">{tileContent}</div>
                </div>
            );
        });

        // Mobile Menu Component
        const MobileMenu = memo(({isOpen,navItems,currentView}) => {
            if(!isOpen) return null;
            return (
                <div className="md:hidden fixed inset-0 z-40 bg-black/95 backdrop-blur-md">
                    <div className="h-full pt-20 pb-6">
                        <div className="container mx-auto px-4 py-4">
                            <div className="space-y-2">
                                {navItems.map(i=>(
                                    <a key={i.label} onClick={i.onClick} href={i.href} className="flex items-center gap-3 p-3 rounded-lg hover:bg-white/10 transition-all cursor-pointer text-white">
                                        <div style={{color:'white'}}>{i.icon}</div>
                                        <span className="font-medium text-white">{i.label}</span>
                                    </a>
                                ))}
                                <a href="index-en.html" className="flex items-center gap-3 p-3 rounded-lg hover:bg-white/10 transition-all cursor-pointer text-white">
                                    <div style={{color:'white'}}>{Icons.lang}</div>
                                    <span className="font-medium text-white">English</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            );
        });

        // Main App Component
        function App() {
            const [state, setState] = useState({
                activeIndex:0,
                timeLeft:{},
                isMobileMenuOpen:false,
                isProgressPaused:false,
                showPauseIndicator:false,
                currentView:'splash',
                isMobileView:window.innerWidth<=MOBILE_BREAKPOINT,
                progressKey:0,
                isInitialized:false,
                isTransitioning:false,
                showGridProgress:false,
                accentColor:'#fe4445',
                touchStart:null,
                touchEnd:null
            });

            const timers = useRef({
                lastWheelTime:0,
                autoPlayTimer:null,
                countdownTimer:null,
                gridTimer:null,
                transitionTimer:null,
                pauseTimer:null
            });

            const currentProperty = useMemo(() => PROPERTIES[state.activeIndex], [state.activeIndex]);
            const navItems = useMemo(() => createNavItems(goToGrid), []);

            // Cleanup all timers
            useEffect(() => {
                return () => {
                    Object.values(timers.current).forEach(timer => {
                        if(timer && typeof timer === 'object') {
                            clearTimeout(timer);
                            clearInterval(timer);
                        }
                    });
                };
            }, []);

            // Initialize
            useEffect(() => {
                const color = getCSSVariable('--accent-primary');
                if(color) setState(prev => ({...prev, accentColor: color}));
                setState(prev => ({...prev, isInitialized: true}));
                new Image().src = PROPERTIES[0].image;
                
                timers.current.autoPlayTimer = setTimeout(() => {
                    setState(prev => ({...prev, currentView: 'grid', showGridProgress: true}));
                    timers.current.gridTimer = setTimeout(() => {
                        setState(prev => ({...prev, showGridProgress: false}));
                        startHeroSequence(0);
                    }, GRID_PROGRESS_DURATION);
                }, SPLASH_DURATION);
            }, []);

            // Resize handler
            useEffect(() => {
                const handleResize = debounce(() => {
                    setState(prev => ({...prev, isMobileView: window.innerWidth <= MOBILE_BREAKPOINT}));
                }, DEBOUNCE_DELAY);
                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            // Auto-rotate
            useEffect(() => {
                if(state.isProgressPaused || state.currentView !== 'hero' || state.isTransitioning) return;
                
                timers.current.autoPlayTimer = setInterval(() => {
                    setState(prev => {
                        const nextIndex = (prev.activeIndex + 1) % PROPERTIES.length;
                        if(nextIndex === 0) {
                            if(timers.current.autoPlayTimer) clearInterval(timers.current.autoPlayTimer);
                            setTimeout(() => {
                                setState(x => ({...x, currentView: 'grid', showGridProgress: true}));
                                timers.current.gridTimer = setTimeout(() => {
                                    setState(x => ({...x, showGridProgress: false}));
                                    startHeroSequence(0);
                                }, GRID_PROGRESS_DURATION);
                            }, 100);
                            return prev;
                        }
                        return {...prev, activeIndex: nextIndex, progressKey: prev.progressKey + 1};
                    });
                }, AUTO_PLAY_INTERVAL);
                
                return () => {
                    if(timers.current.autoPlayTimer) clearInterval(timers.current.autoPlayTimer);
                    if(timers.current.gridTimer) clearTimeout(timers.current.gridTimer);
                };
            }, [state.activeIndex, state.isProgressPaused, state.currentView, state.isTransitioning]);

            // Countdown timer
            useEffect(() => {
                const calculateTimeLeft = () => {
                    const now = new Date();
                    const newTimeLeft = {};
                    PROPERTIES.forEach(prop => {
                        if(!prop.countdown) return;
                        const diff = prop.countdown - now;
                        if(diff > 0) {
                            newTimeLeft[prop.id] = {
                                jours: Math.floor(diff / 86400000),
                                heures: Math.floor((diff / 3600000) % 24),
                                minutes: Math.floor((diff / 60000) % 60),
                                secondes: Math.floor((diff / 1000) % 60)
                            };
                        }
                    });
                    setState(prev => ({...prev, timeLeft: newTimeLeft}));
                };
                
                calculateTimeLeft();
                timers.current.countdownTimer = setInterval(calculateTimeLeft, COUNTDOWN_INTERVAL);
                return () => clearInterval(timers.current.countdownTimer);
            }, []);

            // Handlers
            const startHeroSequence = useCallback((index) => {
                if(timers.current.gridTimer) clearTimeout(timers.current.gridTimer);
                setState(prev => ({
                    ...prev,
                    showGridProgress: false,
                    activeIndex: index,
                    progressKey: prev.progressKey + 1,
                    currentView: 'hero',
                    isMobileMenuOpen: false
                }));
            }, []);

            const handlePropertyChange = useCallback((index) => {
                if(state.currentView !== 'hero' || index === state.activeIndex || state.isTransitioning) return;
                setState(prev => ({...prev, isTransitioning: true}));
                timers.current.transitionTimer = setTimeout(() => {
                    setState(prev => ({
                        ...prev,
                        activeIndex: index,
                        progressKey: prev.progressKey + 1,
                        isTransitioning: false,
                        isMobileMenuOpen: false
                    }));
                }, TRANSITION_DELAY);
            }, [state.activeIndex, state.currentView, state.isTransitioning]);

            const handleProgressLineClick = useCallback((index) => {
                if(index === state.activeIndex) {
                    setState(prev => ({...prev, isProgressPaused: !prev.isProgressPaused, showPauseIndicator: true}));
                    timers.current.pauseTimer = setTimeout(() => {
                        setState(prev => ({...prev, showPauseIndicator: false}));
                    }, PAUSE_INDICATOR_DURATION);
                } else {
                    handlePropertyChange(index);
                    setState(prev => ({...prev, isProgressPaused: false}));
                }
            }, [state.activeIndex, handlePropertyChange]);

            const handleNavigation = useCallback((direction) => {
                const nextIndex = direction === 'next' 
                    ? (state.activeIndex + 1) % PROPERTIES.length
                    : state.activeIndex === 0 ? PROPERTIES.length - 1 : state.activeIndex - 1;
                
                if(direction === 'next' && nextIndex === 0) {
                    setState(prev => ({...prev, currentView: 'grid', showGridProgress: true}));
                    timers.current.gridTimer = setTimeout(() => {
                        setState(prev => ({...prev, showGridProgress: false}));
                        startHeroSequence(0);
                    }, GRID_PROGRESS_DURATION);
                } else {
                    handlePropertyChange(nextIndex);
                    setState(prev => ({...prev, isProgressPaused: false}));
                }
            }, [state.activeIndex, handlePropertyChange, startHeroSequence]);

            // Keyboard and wheel handlers
            useEffect(() => {
                if(state.currentView !== 'hero') return;

                const handleKeyDown = (e) => {
                    if(state.isTransitioning) return;
                    switch(e.key) {
                        case 'ArrowLeft':
                            e.preventDefault();
                            handleNavigation('prev');
                            break;
                        case 'ArrowRight':
                            e.preventDefault();
                            handleNavigation('next');
                            break;
                        case ' ':
                        case 'Spacebar':
                            e.preventDefault();
                            setState(prev => ({...prev, isProgressPaused: !prev.isProgressPaused, showPauseIndicator: true}));
                            timers.current.pauseTimer = setTimeout(() => {
                                setState(prev => ({...prev, showPauseIndicator: false}));
                            }, PAUSE_INDICATOR_DURATION);
                            break;
                    }
                };

                const handleWheel = (e) => {
                    if(state.isTransitioning || state.isMobileView) return;
                    const now = Date.now();
                    if(now - timers.current.lastWheelTime < WHEEL_THROTTLE) return;
                    if(Math.abs(e.deltaY) > 50 || Math.abs(e.deltaX) > 50) {
                        e.preventDefault();
                        timers.current.lastWheelTime = now;
                        const delta = Math.abs(e.deltaX) > Math.abs(e.deltaY) ? e.deltaX : e.deltaY;
                        handleNavigation(delta > 0 ? 'next' : 'prev');
                    }
                };

                window.addEventListener('keydown', handleKeyDown);
                window.addEventListener('wheel', handleWheel, {passive: false});
                return () => {
                    window.removeEventListener('keydown', handleKeyDown);
                    window.removeEventListener('wheel', handleWheel);
                };
            }, [state.currentView, state.isTransitioning, state.isMobileView, handleNavigation]);

            // Touch handlers
            const handleTouchStart = useCallback((e) => {
                if(state.currentView !== 'hero') return;
                const touch = e.touches[0];
                setState(prev => ({...prev, touchStart: touch.clientX, touchEnd: touch.clientX}));
            }, [state.currentView]);

            const handleTouchMove = useCallback((e) => {
                if(state.currentView !== 'hero') return;
                setState(prev => ({...prev, touchEnd: e.touches[0].clientX}));
            }, [state.currentView]);

            const handleTouchEnd = useCallback(() => {
                if(state.currentView !== 'hero' || state.isTransitioning || !state.touchStart) return;
                const diff = state.touchStart - state.touchEnd;
                if(Math.abs(diff) < TOUCH_THRESHOLD) return;
                handleNavigation(diff > 0 ? 'next' : 'prev');
            }, [state.currentView, state.isTransitioning, state.touchStart, state.touchEnd, handleNavigation]);

            const goToGrid = useCallback(() => {
                if(timers.current.gridTimer) clearTimeout(timers.current.gridTimer);
                setState(prev => ({...prev, showGridProgress: false, currentView: 'grid', isMobileMenuOpen: false}));
            }, []);

            const getLogoScale = useCallback((property, isMobile) => {
                const scales = LOGO_SCALES[property.id] || { mobile: 1.0824, desktop: .82 };
                return isMobile ? scales.mobile : scales.desktop;
            }, []);

            const ctaButtonStyle = useMemo(() => {
                const colors = generateColorShades(currentProperty.color);
                return {
                    background: `linear-gradient(135deg, ${colors.base}, ${colors.light}, ${colors.base})`,
                    boxShadow: `0 10px 40px rgba(0,0,0,.3), 0 0 80px ${colors.glow}, inset 0 0 20px rgba(255,255,255,.1)`
                };
            }, [currentProperty.color]);

            if(!state.isInitialized) return (
                <div style={{minHeight:'100vh',background:'#000',color:'white',display:'flex',alignItems:'center',justifyContent:'center'}}>
                    <img src="images/tonic-logo.png" alt="Groupe Tonic" style={{width:'clamp(200px,40vw,300px)',height:'auto'}} />
                </div>
            );

            return (
                <div data-current-view={state.currentView} className={state.isMobileView?'mobile-container':''}>
                    {/* Splash */}
                    <div className={`view-container ${state.currentView==='splash'?'active':''}`}>
                        <div className="splash-container">
                            <img src="images/tonic-logo.png" alt="Groupe Tonic" className="splash-logo" />
                            <p className="splash-tagline">Créateur d'expériences mémorables</p>
                        </div>
                    </div>

                    {/* Grid */}
                    <div className={`view-container ${state.currentView==='grid'?'active':''}`}>
                        <div className="grid-selection-container">
                            <Header 
                                goToGrid={goToGrid} 
                                isMobileMenuOpen={state.isMobileMenuOpen} 
                                setIsMobileMenuOpen={v=>setState(p=>({...p,isMobileMenuOpen:v}))} 
                                currentView={state.currentView}
                            />
                            <div className="grid-wrapper">
                                <div className="selection-grid">
                                    {PROPERTIES.map((p,i)=><PropertyTile key={p.id} property={p} index={i} onClick={startHeroSequence}/>)}
                                </div>
                            </div>
                            {state.showGridProgress&&<div className="grid-progress-bar" style={{display:'block'}}><div className="grid-progress-fill"/></div>}
                            <MobileMenu isOpen={state.isMobileMenuOpen} navItems={navItems} currentView={state.currentView}/>
                        </div>
                    </div>

                    {/* Hero */}
                    <div className={`view-container ${state.currentView==='hero'?'active':''}`}>
                        <div className="min-h-screen relative overflow-hidden" style={{minHeight:state.isMobileView?'100dvh':'100vh'}} 
                             onTouchStart={handleTouchStart} onTouchMove={handleTouchMove} onTouchEnd={handleTouchEnd}>
                            {/* Background */}
                            <div className="absolute inset-0">
                                <div className="hero-bg absolute inset-0 bg-cover bg-center" style={{
                                    backgroundImage:currentProperty.image?`url(${currentProperty.image})`:'none',
                                    backgroundColor:currentProperty.color,
                                    opacity:state.isTransitioning?.7:1,
                                    transition:'opacity 0.5s ease-in-out'
                                }}/>
                                <div className={`absolute inset-0 bg-gradient-to-r ${currentProperty.theme.primary} opacity-50`} style={{
                                    opacity:state.isTransitioning?.3:.5,
                                    transition:'opacity 0.5s ease-in-out'
                                }}/>
                                <div className={`absolute inset-0 bg-gradient-to-br ${currentProperty.theme.secondary} opacity-25`}/>
                                <div className="absolute inset-0 bg-gradient-to-b from-black/50 via-transparent to-black/70"/>
                                {state.currentView==='hero'&&!state.isMobileView&&(
                                    <div className="absolute inset-0">
                                        {[...Array(PARTICLE_COUNT)].map((_,i)=>(
                                            <div key={i} className="particle" style={{
                                                left:`${Math.random()*100}%`,
                                                top:`${Math.random()*100}%`,
                                                animationDelay:`${Math.random()*12}s`,
                                                background:currentProperty.color,
                                                opacity:state.isTransitioning?0:.6,
                                                transition:'opacity 0.5s ease-in-out'
                                            }}/>
                                        ))}
                                    </div>
                                )}
                            </div>

                            <Header 
                                goToGrid={goToGrid} 
                                isMobileMenuOpen={state.isMobileMenuOpen} 
                                setIsMobileMenuOpen={v=>setState(p=>({...p,isMobileMenuOpen:v}))} 
                                currentView={state.currentView}
                            />

                            {/* Side Nav */}
                            <div className="hidden lg:block side-nav-wrapper">
                                <div className="glass rounded-l-2xl p-4" style={{background:'rgba(0,0,0,0.5)'}}>
                                    <div className="space-y-1">
                                        {PROPERTIES.map((p,i)=>(
                                            <div key={p.id} onClick={()=>handleProgressLineClick(i)} 
                                                 className={`side-nav-item p-3 ${i===state.activeIndex?'active':''}`} 
                                                 style={{'--accent-color':p.color}}>
                                                <div className={`font-semibold text-sm transition-colors ${i===state.activeIndex?'text-white':'text-white hover:text-white'}`}
                                                     style={{color:i===state.activeIndex?(p.menuColor||p.color):''}}>{p.name}</div>
                                                {p.date&&<div className="text-xs text-white mt-1">{p.date}</div>}
                                                {i===state.activeIndex&&(
                                                    <div key={`progress-${state.progressKey}`} className={`progress-bar ${state.isProgressPaused?'paused':''}`} 
                                                        style={{'--accent-color':p.color,background:p.color,boxShadow:`0 0 15px ${p.color}`}}/>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            {/* Mobile Menu */}
                            {state.isMobileMenuOpen&&(
                                <div className="md:hidden fixed inset-0 z-40 bg-black/95 backdrop-blur-md">
                                    <div className="h-full overflow-y-auto pt-16 pb-6">
                                        <div className="container mx-auto px-4 py-4">
                                            <div className="mb-6 pb-6 border-b border-white/10">
                                                <div className="space-y-2">
                                                    {navItems.map(i=>(
                                                        <a key={i.label} onClick={i.onClick} href={i.href} className="flex items-center gap-3 p-3 rounded-lg hover:bg-white/10 transition-all cursor-pointer text-white">
                                                            <div style={{color:'white'}}>{i.icon}</div>
                                                            <span className="font-medium text-white">{i.label}</span>
                                                        </a>
                                                    ))}
                                                    <a href="index-en.html" className="flex items-center gap-3 p-3 rounded-lg hover:bg-white/10 transition-all cursor-pointer text-white">
                                                        <div style={{color:'white'}}>{Icons.lang}</div>
                                                        <span className="font-medium text-white">English</span>
                                                    </a>
                                                </div>
                                            </div>
                                            <div className="space-y-2">
                                                {PROPERTIES.map((p,i)=>(
                                                    <button key={p.id} onClick={()=>{
                                                        if(i===state.activeIndex){
                                                            setState(x=>({...x,isProgressPaused:!x.isProgressPaused,showPauseIndicator:true,isMobileMenuOpen:false}));
                                                            timers.current.pauseTimer = setTimeout(()=>setState(x=>({...x,showPauseIndicator:false})),PAUSE_INDICATOR_DURATION);
                                                        } else {
                                                            handlePropertyChange(i);
                                                            setState(x=>({...x,isProgressPaused:false}));
                                                        }
                                                    }} className={`w-full text-left p-3 rounded-lg transition-all ${i===state.activeIndex?'bg-white/10':'hover:bg-white/5'}`}>
                                                        <div className="flex items-center gap-3">
                                                            <div className="w-1 h-10 rounded-full" style={{backgroundColor:i===state.activeIndex?p.color:'rgba(255,255,255,0.2)'}}/>
                                                            <div>
                                                                <div className="font-semibold text-white text-sm" style={{color:i===state.activeIndex?(p.menuColor||p.color):'white'}}>{p.name}</div>
                                                                {p.date&&<div className="text-xs text-white mt-0.5">{p.date}</div>}
                                                            </div>
                                                        </div>
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Mobile Dots */}
                            <div className="mobile-dots">
                                <div className="swipe-indicator">← Glisser / Toucher →</div>
                                <div className="dots-container">
                                    {PROPERTIES.map((_,i)=>(
                                        <button key={i} onClick={()=>{
                                            if(i===state.activeIndex){
                                                setState(x=>({...x,isProgressPaused:!x.isProgressPaused,showPauseIndicator:true}));
                                                timers.current.pauseTimer = setTimeout(()=>setState(x=>({...x,showPauseIndicator:false})),PAUSE_INDICATOR_DURATION);
                                            } else {
                                                handlePropertyChange(i);
                                                setState(x=>({...x,isProgressPaused:false}));
                                            }
                                        }} className={`dot ${i===state.activeIndex?'active':''}`} style={{'--accent-color':currentProperty.color}}/>
                                    ))}
                                </div>
                            </div>

                            {/* Desktop Progress */}
                            <div className="desktop-progress">
                                {PROPERTIES.map((_,i)=>(
                                    <button key={`line-${state.progressKey}-${i}`} onClick={()=>handleProgressLineClick(i)}
                                        className={`progress-line ${i===state.activeIndex?'active':''} ${state.isProgressPaused?'paused':''}`}
                                        style={{'--accent-color':currentProperty.color}}/>
                                ))}
                            </div>

                            {/* Pause Indicator */}
                            <div className={`pause-indicator ${state.showPauseIndicator?'visible':''}`}>
                                <div className="pause-icon">
                                    <div className="pause-bar"></div>
                                    <div className="pause-bar"></div>
                                </div>
                            </div>

                            {/* Main Content */}
                            <main className="hero-main-content relative z-10 min-h-screen flex items-center px-4 sm:px-6 md:px-12 lg:px-20 xl:px-24 2xl:px-32 py-12 sm:py-16 md:py-20">
                                <div className="container mx-auto max-w-7xl">
                                    <div className="lg:pr-80 xl:pr-96">
                                        <div className="hero-content max-w-4xl text-left" key={state.activeIndex} data-dock619={currentProperty.id === 7 ? "true" : "false"}>
                                            {/* Logo */}
                                            {currentProperty.logo&&currentProperty.id!==7&&currentProperty.id!==6&&(
                                                <div className="hero-logo-container mb-4 sm:mb-6" style={{'--child-index':0}}>
                                                    <img src={currentProperty.logo} alt={`Logo ${currentProperty.name}`} className="sm:h-14 md:h-16 lg:h-20 xl:h-24 object-contain opacity-90"
                                                        style={{filter:'drop-shadow(0 2px 8px rgba(0,0,0,0.8))',height:state.isMobileView?'auto':undefined,
                                                        maxHeight:state.isMobileView?'4rem':undefined,transform:`scale(${getLogoScale(currentProperty,state.isMobileView)})`,
                                                        transformOrigin:'left center'}} loading="lazy"/>
                                                </div>
                                            )}

                                            {/* Title */}
                                            {currentProperty.id===7?(
                                                <div className="hero-logo-container mb-4 sm:mb-6" style={{'--child-index':1}}>
                                                    <img src="images/dock619-logo-2.png" alt="DOCK 619" className="sm:h-14 md:h-16 lg:h-20 xl:h-24 object-contain"
                                                        style={{filter:'drop-shadow(0 4px 20px rgba(0,0,0,0.8))',height:state.isMobileView?'auto':undefined,
                                                        maxHeight:state.isMobileView?'4rem':undefined,transform:`scale(${getLogoScale(currentProperty,state.isMobileView)})`,
                                                        transformOrigin:'left center'}} loading="lazy"/>
                                                </div>
                                            ):currentProperty.id===6?(
                                                <>
                                                    <div className="hero-logo-container mb-4 sm:mb-6" style={{'--child-index':0,paddingTop:state.isMobileView?'0.5rem':'0'}}>
                                                        <img src="images/studio76-logo.png" alt="Studio 76" className="sm:h-14 md:h-16 lg:h-20 xl:h-24 object-contain opacity-90"
                                                            style={{filter:'drop-shadow(0 2px 8px rgba(0,0,0,0.8))',height:state.isMobileView?'auto':undefined,
                                                            maxHeight:state.isMobileView?'4.5rem':undefined,transform:`scale(${getLogoScale(currentProperty,state.isMobileView)})`,
                                                            transformOrigin:'left center'}} loading="lazy"/>
                                                    </div>
                                                    <h2 className="font-black mb-4 sm:mb-6 text-white text-left text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl"
                                                        style={{'--child-index':1,textShadow:'0 4px 20px rgba(0,0,0,0.8)',lineHeight:'0.9',
                                                        margin:'0',marginBottom:window.innerWidth<640?'1rem':'1.5rem',padding:'0'}}>{currentProperty.name}</h2>
                                                </>
                                            ):(
                                                <h2 className={`font-black mb-4 sm:mb-6 text-white text-left ${currentProperty.id===3?'text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl':'text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl'}`}
                                                    style={{'--child-index':1,textShadow:'0 4px 20px rgba(0,0,0,0.8)',lineHeight:'0.9',
                                                    margin:'0',marginBottom:window.innerWidth<640?'1rem':'1.5rem',padding:'0'}}>{currentProperty.name}</h2>
                                            )}

                                            {/* Tagline */}
                                            <div className="mb-6 sm:mb-8 max-w-3xl" style={{'--child-index':2}}>
                                                <p className="text-lg sm:text-xl md:text-2xl lg:text-3xl text-white font-light text-left"
                                                   style={{textShadow:'0 2px 10px rgba(0,0,0,0.8)',lineHeight:'1.4'}}>{currentProperty.tagline}</p>
                                            </div>

                                            {/* Details */}
                                            {(currentProperty.date||currentProperty.location)&&(
                                                <div className="flex flex-wrap gap-3 sm:gap-4 mb-6 sm:mb-8" style={{'--child-index':3}}>
                                                    {currentProperty.date&&(
                                                        <div className="flex items-center gap-2 sm:gap-3 bg-black/50 backdrop-blur-md px-4 sm:px-6 py-2 sm:py-3 rounded-full text-white">
                                                            {Icons.cal}
                                                            <span className="font-medium text-sm sm:text-base">{currentProperty.date}</span>
                                                        </div>
                                                    )}
                                                    {currentProperty.location&&(
                                                        <div className="flex items-center gap-2 sm:gap-3 bg-black/50 backdrop-blur-md px-4 sm:px-6 py-2 sm:py-3 rounded-full text-white">
                                                            {Icons.loc}
                                                            <span className="font-medium text-sm sm:text-base">{currentProperty.location}</span>
                                                        </div>
                                                    )}
                                                </div>
                                            )}

                                            {/* Countdown */}
                                            {state.timeLeft[currentProperty.id]&&(
                                                <div className="flex gap-3 sm:gap-4 mb-6 sm:mb-8" style={{'--child-index':4}}>
                                                    {Object.entries(state.timeLeft[currentProperty.id]).map(([unit,value])=>(
                                                        <div key={unit} className="countdown-unit">
                                                            <div className="text-xl sm:text-2xl font-bold text-white">{value}</div>
                                                            <div className="text-xs uppercase text-white">{unit}</div>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}

                                            {/* CTA Button */}
                                            {currentProperty.url!=='#'&&(
                                                <a href={currentProperty.url} target="_blank" rel="noopener noreferrer" 
                                                   className={`cta-button-custom cta-button ${currentProperty.id===7?'dock619-cta':''}`}
                                                   style={{'--child-index':5,...ctaButtonStyle}}>
                                                    <span>{currentProperty.id===7?"Découvrez notre espace":currentProperty.id===6?"Découvrez nos services":"Découvrez l'événement"}</span>
                                                    {Icons.arr}
                                                </a>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </main>
                        </div>
                    </div>
                </div>
            );
        }

        // Initialize
        function init() {
            try {
                const root = document.getElementById('root');
                if(!root) throw new Error('Root element not found');
                if(!window.React||!window.ReactDOM) throw new Error('React not loaded');
                ReactDOM.createRoot(root).render(<App />);
            } catch(e) {
                document.getElementById('root').innerHTML = `
                    <div style="min-height:100vh;background:#000;color:white;display:flex;align-items:center;justify-content:center;padding:2rem;text-align:center">
                        <div>
                            <img src="images/tonic-logo.png" alt="Groupe Tonic" style="width:clamp(200px,40vw,300px);height:auto;margin-bottom:2rem;" />
                            <h2 style="font-size:1.5rem;margin-bottom:1rem;color:#ef4444">Erreur de chargement</h2>
                            <p style="margin-bottom:2rem;opacity:0.8">Une erreur s'est produite lors du chargement de l'application.</p>
                            <button onclick="window.location.reload()" style="padding:0.75rem 2rem;background:white;color:black;border:none;border-radius:50px;font-weight:bold;cursor:pointer;font-size:1rem">
                                Rafraîchir la page
                            </button>
                        </div>
                    </div>`;
            }
        }

        if(document.readyState==='loading') document.addEventListener('DOMContentLoaded',init);
        else init();
    </script>
</body>
</html>
