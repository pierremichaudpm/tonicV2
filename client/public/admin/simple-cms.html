<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS Simple | Groupe Tonic</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">

    <!-- Login -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-sm w-full m-4">
            <h2 class="text-xl font-bold mb-4">Connexion CMS</h2>
            <form id="loginForm">
                <input type="password" id="passwordInput" placeholder="Mot de passe" class="w-full px-3 py-2 border rounded-lg mb-4">
                <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg">Se connecter</button>
            </form>
        </div>
    </div>

    <!-- CMS -->
    <div id="cmsInterface" class="hidden">
        <header class="bg-white shadow p-4">
            <div class="flex justify-between items-center">
                <h1 class="text-xl font-bold">CMS Simple</h1>
                <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded">Déconnexion</button>
            </div>
        </header>

        <div class="max-w-4xl mx-auto p-6">
            <!-- Tabs -->
            <div class="flex mb-6 border-b">
                <button onclick="showTab('news')" id="newsTab" class="px-4 py-2 bg-blue-600 text-white rounded-t">Actualités</button>
                <button onclick="showTab('jobs')" id="jobsTab" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-t ml-2">Emplois</button>
            </div>

            <!-- Add Button -->
            <button onclick="showAddForm()" class="bg-green-600 text-white px-4 py-2 rounded mb-6">+ Ajouter</button>

            <!-- Content List -->
            <div id="contentList" class="space-y-4"></div>
        </div>

        <!-- Add Form -->
        <div id="addModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div class="bg-white rounded-lg p-6 w-full max-w-lg">
                <h2 class="text-xl font-bold mb-4">Ajouter du contenu</h2>
                <form id="addForm">
                    <input type="text" id="title" placeholder="Titre" class="w-full px-3 py-2 border rounded mb-3" required>
                    <input type="text" id="subtitle" placeholder="Sous-titre" class="w-full px-3 py-2 border rounded mb-3" required>
                    <select id="category" class="w-full px-3 py-2 border rounded mb-3" required>
                        <option value="">Catégorie...</option>
                        <option value="Beach Pro Tour">Beach Pro Tour</option>
                        <option value="Grands Prix Cyclistes">Grands Prix Cyclistes</option>
                        <option value="Marathon Beneva 21K">Marathon Beneva 21K</option>
                        <option value="UCI 2026">UCI 2026</option>
                        <option value="Studio 76">Studio 76</option>
                        <option value="Dock 619">Dock 619</option>
                        <option value="21K de Montréal">21K de Montréal</option>
                        <option value="Groupe Tonic">Groupe Tonic</option>
                    </select>
                    <input type="date" id="date" class="w-full px-3 py-2 border rounded mb-3" required>
                    <textarea id="content" placeholder="Contenu" rows="5" class="w-full px-3 py-2 border rounded mb-3" required></textarea>
                    <div id="jobFields" class="hidden">
                        <input type="text" id="salary" placeholder="Salaire" class="w-full px-3 py-2 border rounded mb-3">
                    </div>
                    <div class="flex gap-2">
                        <button type="button" onclick="closeAddForm()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded">Annuler</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded">Enregistrer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="../js/simple-content.js"></script>
    <script>
        let currentTab = 'news';
        let isAuth = false;

        // Login
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            if (document.getElementById('passwordInput').value === 'admin123') {
                document.getElementById('loginModal').classList.add('hidden');
                document.getElementById('cmsInterface').classList.remove('hidden');
                isAuth = true;
                loadContent();
            } else {
                alert('Mot de passe incorrect');
            }
        });

        function logout() {
            isAuth = false;
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('cmsInterface').classList.add('hidden');
        }

        // Tabs
        function showTab(tab) {
            currentTab = tab;
            document.getElementById('newsTab').className = tab === 'news' ? 'px-4 py-2 bg-blue-600 text-white rounded-t' : 'px-4 py-2 bg-gray-300 text-gray-700 rounded-t';
            document.getElementById('jobsTab').className = tab === 'jobs' ? 'px-4 py-2 bg-blue-600 text-white rounded-t ml-2' : 'px-4 py-2 bg-gray-300 text-gray-700 rounded-t ml-2';
            document.getElementById('jobFields').classList.toggle('hidden', tab !== 'jobs');
            loadContent();
        }

        // Load content
        function loadContent() {
            const items = currentTab === 'news' ? getNews() : getJobs();
            const list = document.getElementById('contentList');
            
            list.innerHTML = items.map(item => `
                <div class="bg-white p-4 rounded-lg shadow">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="font-bold">${item.title}</h3>
                            <p class="text-gray-600 text-sm">${item.subtitle}</p>
                            <span class="inline-block px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded mt-2">${item.category}</span>
                            ${item.salary ? `<span class="inline-block px-2 py-1 bg-green-100 text-green-800 text-xs rounded mt-2 ml-1">${item.salary}</span>` : ''}
                        </div>
                        <button onclick="deleteItem(${item.id})" class="bg-red-600 text-white px-3 py-1 rounded text-sm">Supprimer</button>
                    </div>
                </div>
            `).join('');
        }

        // Add form
        function showAddForm() {
            document.getElementById('addForm').reset();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            document.getElementById('addModal').classList.remove('hidden');
        }

        function closeAddForm() {
            document.getElementById('addModal').classList.add('hidden');
        }

        // Add content
        document.getElementById('addForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newItem = {
                title: document.getElementById('title').value,
                subtitle: document.getElementById('subtitle').value,
                category: document.getElementById('category').value,
                date: document.getElementById('date').value,
                content: document.getElementById('content').value,
                type: currentTab
            };
            
            if (currentTab === 'job') {
                newItem.salary = document.getElementById('salary').value || 'À discuter';
            }
            
            addNewContent(newItem);
            closeAddForm();
            loadContent();
        });

        // Delete
        function deleteItem(id) {
            if (confirm('Supprimer cet élément ?')) {
                deleteContent(id);
                loadContent();
            }
        }
    </script>
</body>
</html>